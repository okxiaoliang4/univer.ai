import { Callout, Tabs } from 'nextra/components'
import VersionBadge from '@/components/version-badge'

# 核心功能

| 有付费版本 | 需要接入服务端 | 可用于 Univer on Node.js | 包含的 Preset |
| - | - | - | - |
| - | - | ✅ | `UniverSheetsCorePreset` |

核心功能是实现电子表格的基础功能，包含了 Univer Sheet 的核心功能，如创建工作簿、单元格编辑、单元格选择、公式、数字格式等。

该功能包含以下插件包：

* [`@univerjs/engine-render`](https://www.npmjs.com/package/@univerjs/engine-render) - 渲染引擎插件
* [`@univerjs/engine-formula`](https://www.npmjs.com/package/@univerjs/engine-formula) - 公式引擎插件
* [`@univerjs/ui`](https://www.npmjs.com/package/@univerjs/ui) - 基础UI插件
* [`@univerjs/docs`](https://www.npmjs.com/package/@univerjs/docs) - docs插件
* [`@univerjs/docs-ui`](https://www.npmjs.com/package/@univerjs/docs-ui) - docs-UI插件
* [`@univerjs/sheets`](https://www.npmjs.com/package/@univerjs/sheets) - sheets插件
* [`@univerjs/sheets-ui`](https://www.npmjs.com/package/@univerjs/sheets-ui) - sheets-UI插件
* [`@univerjs/sheets-formula`](https://www.npmjs.com/package/@univerjs/sheets-formula) - 公式插件
* [`@univerjs/sheets-formula-ui`](https://www.npmjs.com/package/@univerjs/sheets-formula-ui) - 公式UI插件
* [`@univerjs/sheets-numfmt`](https://www.npmjs.com/package/@univerjs/sheets-numfmt) - 数字格式插件

<Callout>
  TODO: add example
</Callout>

## Preset 安装

<Tabs items={['pnpm', 'npm']}>
  <Tabs.Tab>
    ```shell
    pnpm add @univerjs/core @univerjs/design @univerjs/engine-formula @univerjs/engine-render @univerjs/ui @univerjs/docs @univerjs/docs-ui @univerjs/sheets @univerjs/sheets-ui @univerjs/sheets-formula @univerjs/sheets-formula-ui @univerjs/sheets-numfmt 
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```shell
    npm install @univerjs/core @univerjs/design @univerjs/engine-formula @univerjs/engine-render @univerjs/ui @univerjs/docs @univerjs/docs-ui @univerjs/sheets @univerjs/sheets-ui @univerjs/sheets-formula @univerjs/sheets-formula-ui @univerjs/sheets-numfmt
    ```
  </Tabs.Tab>
</Tabs>

```ts {2-3,10,15}
import { createUniver, defaultTheme, LocaleType, Tools } from '@univerjs/presets';
import { UniverSheetsCorePreset } from '@univerjs/presets/preset-sheets-core';
import sheetsCoreZhCN from '@univerjs/presets/preset-sheets-core/locales/zh-CN';

const { univerAPI } = createUniver({
    locale: LocaleType.ZH_CN,
    locales: {
        zhCN: Tools.deepMerge(
            {},
            sheetsCoreZhCN
        ),
    },
    theme: defaultTheme,
    presets: [
        UniverSheetsCorePreset(),
    ]
});
```

```typescript
import "@univerjs/design/lib/index.css";
import "@univerjs/ui/lib/index.css";
import "@univerjs/docs-ui/lib/index.css";
import "@univerjs/sheets-ui/lib/index.css";
import "@univerjs/sheets-formula-ui/lib/index.css";

import { Univer } from "@univerjs/core";
import { defaultTheme } from "@univerjs/design";

import { UniverFormulaEnginePlugin } from "@univerjs/engine-formula";
import { UniverRenderEnginePlugin } from "@univerjs/engine-render";

import { UniverUIPlugin } from "@univerjs/ui";

import { UniverDocsPlugin } from "@univerjs/docs";
import { UniverDocsUIPlugin } from "@univerjs/docs-ui";

import { UniverSheetsPlugin } from "@univerjs/sheets";
import { UniverSheetsFormulaPlugin } from "@univerjs/sheets-formula";
import { UniverSheetsUIPlugin } from "@univerjs/sheets-ui";
import { UniverSheetsFormulaUIPlugin } from "@univerjs/sheets-formula-ui";
```

## 国际化

```typescript
import { LocaleType, Tools } from '@univerjs/core';
import DesignZhCN from '@univerjs/design/locale/zh-CN';
import DocsUIZhCN from '@univerjs/docs-ui/locale/zh-CN';
import SheetsZhCN from '@univerjs/sheets/locale/zh-CN';
import SheetsUIZhCN from '@univerjs/sheets-ui/locale/zh-CN';
import SheetsFormulaUIZhCN from '@univerjs/sheets-formula-ui/locale/zh-CN';
import UIZhCN from '@univerjs/ui/locale/zh-CN';

const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: Tools.deepMerge(
      DesignZhCN,
      DocsUIZhCN,
      SheetsZhCN,
      SheetsUIZhCN,
      SheetsFormulaUIZhCN,
      UIZhCN
    ),
  },
});
```

## 注册

```typescript
univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
});

univer.registerPlugin(UniverDocsPlugin);
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);
univer.registerPlugin(UniverSheetsFormulaUIPlugin);
univer.createUnit(UniverInstanceType.UNIVER_SHEET, {});
```

## 配置

### `@univerjs/core`

`@univerjs/core` 在初始化时提供了一些配置项，可用于配置主题、国际化等。

```typescript
new Univer({
  theme: IStyleSheet;
  locale: LocaleType;
  locales: ILocales;
  logLevel?: LogLevel;
});
```

完整的配置项参考 [IUniverConfig](https://github.com/dream-num/univer/blob/dev/packages/core/src/univer.ts#L57-L63)。

### `@univerjs/ui`

`@univerjs/ui` 提供了一些配置项，可用于基础布局的配置。

```typescript
univer.registerPlugin(UniverUIPlugin, {
  container?: string | HTMLElement;

  header?: boolean;
  footer?: boolean;
  contextMenu?: boolean;

  disableAutoFocus?: true;
  override?: DependencyOverride;
  menu?: MenuConfig;
});
```

* `container` - 容器元素，可以是字符串或者 DOM 元素。
* `header` - 是否显示头部。
* `toolbar` - 是否显示头部工具栏。 <VersionBadge version="0.2.0+" />
* `footer` - 是否显示底部。
* `contextMenu` - 是否显示右键菜单。
* `disableAutoFocus` - 是否禁用自动聚焦。
* `override` - 依赖注入的覆盖配置。
* `menu` - 菜单配置，详见[定制菜单项（隐藏菜单项）](/guides/sheets/advanced/custom-ui#定制菜单项隐藏菜单项)
